require 'rest-client'
require 'JSON'

wineData = RestClient.get('https://api.globalwinescore.com/globalwinescores/latest?limit=500&is_primeurs=true',
{:Authorization=> 'Token fedc2e80db0640426d5792f6b7c56f2c782ea233' })


parsedWineData = JSON.parse(wineData)

# parsedWineData = {"count"=>1844, "next"=>"https://api.globalwinescore.com/globalwinescores/latest/?is_primeurs=true&limit=500&offset=500", "previous"=>nil, "results"=>[{"wine"=>"Chateau Ausone, Saint Emilion Grand Cru", "wine_id"=>32209, "wine_slug"=>"chateau-ausone-saint-emilion-grand-cru", "appellation"=>"Saint Emilion Grand Cru", "appellation_slug"=>"saint-emilion-grand-cru", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"Premier Grand Cru classé A", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.54, "confidence_index"=>"A+", "journalist_count"=>13, "lwin"=>1006205, "lwin_11"=>10062052018}, {"wine"=>"Chateau Lafleur, Pomerol", "wine_id"=>37920, "wine_slug"=>"chateau-lafleur-pomerol", "appellation"=>"Pomerol", "appellation_slug"=>"pomerol", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>nil, "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.46, "confidence_index"=>"A", "journalist_count"=>12, "lwin"=>1011902, "lwin_11"=>10119022018}, {"wine"=>"Chateau Leoville Las Cases, Grand Vin De Leoville, Saint Julien", "wine_id"=>38501, "wine_slug"=>"chateau-leoville-las-cases-grand-vin-de-leoville-saint-julien", "appellation"=>"Saint Julien", "appellation_slug"=>"saint-julien", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"2eme Grand Cru classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.41, "confidence_index"=>"A+", "journalist_count"=>14, "lwin"=>1012374, "lwin_11"=>10123742018}, {"wine"=>"Vieux Chateau Certan, Pomerol", "wine_id"=>147420, "wine_slug"=>"vieux-chateau-certan-pomerol", "appellation"=>"Pomerol", "appellation_slug"=>"pomerol", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>nil, "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.4, "confidence_index"=>"A+", "journalist_count"=>12, "lwin"=>1016082, "lwin_11"=>10160822018}, {"wine"=>"Chateau Cheval Blanc, Saint Emilion Grand Cru", "wine_id"=>33249, "wine_slug"=>"chateau-cheval-blanc-saint-emilion-grand-cru", "appellation"=>"Saint Emilion Grand Cru", "appellation_slug"=>"saint-emilion-grand-cru", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"Premier Grand Cru classé A", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.33, "confidence_index"=>"A+", "journalist_count"=>13, "lwin"=>1008108, "lwin_11"=>10081082018}, {"wine"=>"Chateau Lafite Rothschild, Pauillac", "wine_id"=>37901, "wine_slug"=>"chateau-lafite-rothschild-pauillac", "appellation"=>"Pauillac", "appellation_slug"=>"pauillac", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"1er Grand Cru Classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.23, "confidence_index"=>"A", "journalist_count"=>13, "lwin"=>1011872, "lwin_11"=>10118722018}, {"wine"=>"Chateau Latour, Pauillac", "wine_id"=>38177, "wine_slug"=>"chateau-latour-pauillac", "appellation"=>"Pauillac", "appellation_slug"=>"pauillac", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"1er Grand Cru Classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>98.19, "confidence_index"=>"A+", "journalist_count"=>13, "lwin"=>1012316, "lwin_11"=>10123162018}, {"wine"=>"Chateau Cos D'Estournel, Saint Estephe", "wine_id"=>33389, "wine_slug"=>"chateau-cos-destournel-saint-estephe", "appellation"=>"Saint Estephe", "appellation_slug"=>"saint-estephe", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"2eme Grand Cru classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.99, "confidence_index"=>"A", "journalist_count"=>13, "lwin"=>1008788, "lwin_11"=>10087882018}, {"wine"=>"Chateau Mouton Rothschild, Pauillac", "wine_id"=>39642, "wine_slug"=>"chateau-mouton-rothschild-pauillac", "appellation"=>"Pauillac", "appellation_slug"=>"pauillac", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"1er Grand Cru Classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.86, "confidence_index"=>"A", "journalist_count"=>13, "lwin"=>1013544, "lwin_11"=>10135442018}, {"wine"=>"Chateau Margaux, Margaux", "wine_id"=>39051, "wine_slug"=>"chateau-margaux-margaux", "appellation"=>"Margaux", "appellation_slug"=>"margaux", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"1er Grand Cru Classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.81, "confidence_index"=>"A", "journalist_count"=>13, "lwin"=>1522619, "lwin_11"=>15226192018}, {"wine"=>"Chateau Figeac, Saint Emilion Grand Cru", "wine_id"=>35687, "wine_slug"=>"chateau-figeac-saint-emilion-grand-cru", "appellation"=>"Saint Emilion Grand Cru", "appellation_slug"=>"saint-emilion-grand-cru", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"Premier Grand Cru classé B", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.64, "confidence_index"=>"B+", "journalist_count"=>13, "lwin"=>1009769, "lwin_11"=>10097692018}, {"wine"=>"Chateau Palmer, Margaux", "wine_id"=>39755, "wine_slug"=>"chateau-palmer-margaux", "appellation"=>"Margaux", "appellation_slug"=>"margaux", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"3eme Grand Cru classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.45, "confidence_index"=>"A", "journalist_count"=>14, "lwin"=>1013658, "lwin_11"=>10136582018}, {"wine"=>"Chateau Calon Segur, Saint Estephe", "wine_id"=>32921, "wine_slug"=>"chateau-calon-segur-saint-estephe", "appellation"=>"Saint Estephe", "appellation_slug"=>"saint-estephe", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"3eme Grand Cru classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.41, "confidence_index"=>"A+", "journalist_count"=>14, "lwin"=>1007475, "lwin_11"=>10074752018}, {"wine"=>"Chateau Montrose, Saint Estephe", "wine_id"=>39489, "wine_slug"=>"chateau-montrose-saint-estephe", "appellation"=>"Saint Estephe", "appellation_slug"=>"saint-estephe", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"2eme Grand Cru classé en 1855", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.22, "confidence_index"=>"A", "journalist_count"=>13, "lwin"=>1013296, "lwin_11"=>10132962018}, {"wine"=>"Chateau Angelus, Saint Emilion Grand Cru", "wine_id"=>32167, "wine_slug"=>"chateau-angelus-saint-emilion-grand-cru", "appellation"=>"Saint Emilion Grand Cru", "appellation_slug"=>"saint-emilion-grand-cru", "color"=>"Red", "wine_type"=>"", "regions"=>["Bordeaux"], "country"=>"France", "classification"=>"Premier Grand Cru classé A", "vintage"=>"2018", "date"=>"2019-04-28", "is_primeurs"=>true, "score"=>97.21, "confidence_index"=>"A", "journalist_count"=>14, "lwin"=>1006045, "lwin_11"=>10060452018} ]}



def seedData(hash)
  newHash = {}
  hash["results"].each_with_index do |wine, index|
    newHash[wine["wine"]] = {name: wine["wine"], rating: wine["score"], color: wine["color"], country: wine["country"], year: wine["vintage"], regions: wine["regions"] }
  end
newHash
end

FINEDATA =  seedData(parsedWineData)
